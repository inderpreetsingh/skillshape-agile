{"version":3,"sources":["meteor://ðŸ’»app/packages/jgdovin_html-pdf/packages/jgdovin_html-pdf.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"/packages/jgdovin_html-pdf.js","sourcesContent":["(function () {\n\n/////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                     //\n// packages/jgdovin:html-pdf/server/html-pdf.js                                        //\n//                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////\n                                                                                       //\npdf = Npm.require('html-pdf');                                                         // 1\n                                                                                       // 2\n                                                                                       // 3\nMeteor.startup(function() {                                                            // 4\n  pdfBuffer = function (html, options, cb) {                                           // 5\n    pdf.create(html, options).toBuffer(Meteor.bindEnvironment(function (err, buffer) { // 6\n      cb && cb(null, buffer);                                                          // 7\n      return buffer;                                                                   // 8\n    }));                                                                               // 9\n  };                                                                                   // 10\n});                                                                                    // 11\n                                                                                       // 12\nMeteor.methods({                                                                       // 13\n  pdfStream : function(html, options) {                                                // 14\n    var pdfStream = function (html, options, cb) {                                     // 15\n      pdf.create(html).toStream(Meteor.bindEnvironment(function (err, buffer) {        // 16\n        cb && cb(null, buffer);                                                        // 17\n        return;                                                                        // 18\n      }));                                                                             // 19\n    };                                                                                 // 20\n                                                                                       // 21\n    var stream = Meteor.wrapAsync(pdfStream);                                          // 22\n                                                                                       // 23\n    try {                                                                              // 24\n      var result = stream(html, options);                                              // 25\n      return result;                                                                   // 26\n    } catch (e) {                                                                      // 27\n      console.log(e);                                                                  // 28\n    }                                                                                  // 29\n  },                                                                                   // 30\n  pdfBuffer : function(html, options) {                                                // 31\n    var buffer = Meteor.wrapAsync(pdfBuffer);                                          // 32\n                                                                                       // 33\n    try {                                                                              // 34\n      var result = buffer(html, options);                                              // 35\n      return result;                                                                   // 36\n    } catch (e) {                                                                      // 37\n      console.log(e);                                                                  // 38\n    }                                                                                  // 39\n  },                                                                                   // 40\n  pdfCollection : function(html, options) {                                            // 41\n    var buffer = Meteor.wrapAsync(pdfBuffer);                                          // 42\n                                                                                       // 43\n    try {                                                                              // 44\n      var result = buffer(html, options);                                              // 45\n      var resultId = PdfCollection.insert({pdf:result});                               // 46\n      return resultId;                                                                 // 47\n    } catch (e) {                                                                      // 48\n      console.log(e);                                                                  // 49\n    }                                                                                  // 50\n  }                                                                                    // 51\n});                                                                                    // 52\n                                                                                       // 53\n//we need a publication to keep pdfs inside of.                                        // 54\nMeteor.publish(\"htmlPdfCollection\", function () {                                      // 55\n  return PdfCollection.find();                                                         // 56\n});                                                                                    // 57\n/////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n\n\n\n\n(function () {\n\n/////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                     //\n// packages/jgdovin:html-pdf/lib/index.js                                              //\n//                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////\n                                                                                       //\nif(Meteor.isClient) {                                                                  // 1\n  Meteor.pdf = {                                                                       // 2\n    buffer : function(html, options, cb) {                                             // 3\n      if (arguments.length === 1) {                                                    // 4\n        options = {};                                                                  // 5\n      }                                                                                // 6\n      if (arguments.length === 2 && typeof options === 'function') {                   // 7\n        cb = options;                                                                  // 8\n        options = {};                                                                  // 9\n      }                                                                                // 10\n                                                                                       // 11\n      Meteor.call('pdfBuffer', html, options, function(err, result) {                  // 12\n        cb(result);                                                                    // 13\n      });                                                                              // 14\n    },                                                                                 // 15\n    stream : function(html, options, cb) {                                             // 16\n      if (arguments.length === 1) {                                                    // 17\n        options = {};                                                                  // 18\n      }                                                                                // 19\n      if (arguments.length === 2 && typeof options === 'function') {                   // 20\n        cb = options;                                                                  // 21\n        options = {};                                                                  // 22\n      }                                                                                // 23\n                                                                                       // 24\n      Meteor.call('pdfStream', html, options, function(err, result) {                  // 25\n        cb(result);                                                                    // 26\n      });                                                                              // 27\n    },                                                                                 // 28\n    save : function(html, filename, options) {                                         // 29\n      if (arguments.length === 2){                                                     // 30\n        options = {};                                                                  // 31\n      }                                                                                // 32\n      Meteor.call('pdfCollection', html, options, function(err, result) {              // 33\n        var item = PdfCollection.findOne({_id : result});                              // 34\n        var blob = new Blob([item.pdf], {type: 'application/pdf'});                    // 35\n        saveAs(blob, filename + '.pdf');                                               // 36\n        PdfCollection.remove({_id: result})                                            // 37\n      });                                                                              // 38\n    }                                                                                  // 39\n  };                                                                                   // 40\n}                                                                                      // 41\n                                                                                       // 42\nPdfCollection = new Mongo.Collection('htmlPdfCollection');                             // 43\n                                                                                       // 44\n/////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n\n\n\n\n(function () {\n\n/////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                     //\n// packages/jgdovin:html-pdf/lib/permissions.js                                        //\n//                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////\n                                                                                       //\nPdfCollection.allow({                                                                  // 1\n  remove: function(userId, doc) {                                                      // 2\n    return true;                                                                       // 3\n  }                                                                                    // 4\n});                                                                                    // 5\n/////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n"]}